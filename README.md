# exo_to_aup2.py - .exo → .aup2 コンバーター

## 概要

AviUtlのオブジェクトファイル（`.exo`）を、AviUtl2で導入される新しいプロジェクト形式（`.aup2`）に変換するPythonスクリプトです。
複数のシーン`.exo`ファイルを1つの`.aup2`プロジェクトに統合することができます。

## 主な機能

- 複数の`.exo`ファイル（シーン）の統合
- テキスト、図形、画像、動画、音声などの主要オブジェクトに対応
- 標準描画、カメラ制御、グループ制御の変換
- アニメーション効果（`.anm`, `.anm2`）のパラメータ名を解決し変換
- イージング設定の変換（Type1@Curve Editorのベジェ曲線含む）
- 動画ファイルのFPSを自動検出し、オブジェクトの再生範囲を調整
- Shift_JISでエンコードされた`.exo`ファイルと、UTF-8/Shift_JISのスクリプトファイルを処理

## 使い方

### 1. 準備（環境構築）

#### ステップ1: Pythonのインストール
インストールしていない場合は、以下の手順でインストールしてください。

1.  **[Python公式サイト](https://www.python.org/downloads/)**にアクセスします。
2.  「Download Python 3.x.x」というボタンをクリックして、インストーラーをダウンロードします。
3.  インストーラーを起動したら、**必ず「Add Python to PATH」または「Add python.exe to PATH」というチェックボックスにチェックを入れてください。** これを忘れると、後の手順がうまくいきません。
4.  「Install Now」をクリックして、インストールを開始します。

#### ステップ2: OpenCVライブラリのインストール

次に、動画の情報を読み取るための「OpenCV」というライブラリをインストールします。

1.  Windowsの「スタート」メニューから「コマンドプロンプト」または「PowerShell」を検索して起動します。
2.  黒い画面が開いたら、以下の命令（コマンド）をコピー＆ペーストして、Enterキーを押します。

    ```sh
    pip install opencv-python
    ```

    "Successfully installed..."と表示されれば成功です。

#### ステップ3: 必要なファイルのコピー

このツールが`.exo`ファイルの内容を正しく理解するために、AviUtlで使っている設定ファイルをコピーしてくる必要があります。

1.  **アニメーション効果ファイル（.anm, .anm2）のコピー**
    - **コピー元:** `C:\ProgramData\aviutl2\Script` フォルダの `.anm` また、 `.anm2` ファイルをすべてコピーします。
    - **コピー先:** この`exo_to_aup2-2.py`があるフォルダの中に、新しく`Script`という名前のフォルダを作成し、その中に貼り付けます。

2.  **エフェクト設定ファイル（effect.conf）のコピー**
    - **コピー元:** AviUtlの実行ファイル（`aviutl.exe`など）があるフォルダの中にある`effect.conf`というファイルをコピーします。
    - **コピー先:** この`exo_to_aup2-2.py`があるフォルダの中に、新しく`AviUtl2_doc`という名前のフォルダを作成し、その中に貼り付けます。

これで準備は完了です。

### 2. 実行

以下のコマンド形式でスクリプトを実行します。
入力として、最初にルートとなるシーンの`.exo`ファイルを指定し、続けて他のシーンファイルを指定します。最後に、出力する`.aup2`ファイルの名前を指定してください。

```sh
python exo_to_aup2-2.py <ルートシーン.exo> <シーン1.exo> [シーン2.exo ...] <出力ファイル.aup2>
```

**実行例:**
```sh
# Root.exo と Scene1.exo を読み込んで project.aup2 を生成する
python exo_to_aup2-2.py Root.exo Scene1.exo project.aup2
```

## 注意事項・制限事項

- すべてのAviUtlプラグインやカスタムスクリプトに完全に対応しているわけではありません。
- 未対応の効果やパラメータがあった場合、変換時にコンソールに警告メッセージが出力されることがあります。その場合、該当するオブジェクトは正しく変換されない可能性があります。
- 動画ファイルのFPSがOpenCVで正常に取得できなかった場合、デフォルト値として`30fps`が使用されます。
- AviUtl2の仕様変更によっては、このスクリプトが正しく動作しなくなる可能性があります。
